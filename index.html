<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>부릉라이더스 정산서 조회</title>
<link rel="icon" type="image/png" href="VRriders.png">
<style>
body { font-family: Arial; text-align: center; padding: 20px; }
table { max-width: 600px; width: 100%; border-collapse: collapse; margin: 20px auto; font-size: 16px; }
th, td { border: 1px solid black; padding: 10px; text-align: center; }
th { background-color: #b2dba1; }
td { background-color: #fff; }
.footer, .footer td { background-color: #b2dba1 !important; font-weight: bold; }
input { width: 95%; padding: 8px; font-size: 14px; }
button { background-color: #4CAF50; color: white; padding: 10px 15px; border: none; cursor: pointer; font-size: 16px; margin-top: 10px; }
button:hover { background-color: #45a049; }
#result { margin-top: 20px; }
</style>
</head>
<body>
<h2>부릉라이더스 정산서 조회</h2>
<p>코드 및 정산 문의 : 010-9785-1293</p>

<form id="searchForm">
<table>
<tr><td>입금 날짜</td><td><input type="text" id="searchDate" name="searchDate" placeholder="예: 250307"></td></tr>
<tr><td>검색 코드</td><td><input type="text" id="searchCode" name="searchCode" placeholder="예: C202401001"></td></tr>
</table>
<button type="submit">검색</button>
</form>

<h3>검색 결과</h3>
<div id="result"></div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
// 날짜 변환 yyMMdd → Date
function parseDate(searchDate) {
    var year = parseInt("20" + searchDate.substring(0,2));
    var month = parseInt(searchDate.substring(2,4)) - 1;
    var day = parseInt(searchDate.substring(4,6));
    return new Date(year, month, day);
}

// 기간 계산 (수요일~다음 화요일)
function calculatePeriod(searchDate) {
    var inputDate = parseDate(searchDate);
    var dayOfWeek = inputDate.getDay();
    var wednesdayDate = new Date(inputDate);
    wednesdayDate.setDate(inputDate.getDate() - ((dayOfWeek + 4) % 7));
    var tuesdayDate = new Date(wednesdayDate);
    tuesdayDate.setDate(wednesdayDate.getDate() + 6);
    function formatDate(date){ 
        var mm = String(date.getMonth()+1).padStart(2,'0'); 
        var dd = String(date.getDate()).padStart(2,'0'); 
        return mm+"/"+dd;
    }
    return formatDate(wednesdayDate) + " ~ " + formatDate(tuesdayDate);
}

// 샘플 JSON 데이터 (테스트용)
const sampleData = [
  {
    코드: "C202401001",
    총오더수: 10,
    수령금액: "1,000,000",
    과세전금액: "900,000",
    고용보험: "10,000",
    산재보험: "5,000",
    시간제보험: "2,000",
    보험료소급: "0",
    프로모션: "50,000",
    소득세: "33,000",
    실지급액: "900,000",
    "1차지급액": "500,000",
    "2차지급액": "400,000",
    정산문의: "010-9785-1293",
    입금날짜: "250307"
  },
  {
    코드: "C202401002",
    총오더수: 5,
    수령금액: "500,000",
    과세전금액: "450,000",
    고용보험: "5,000",
    산재보험: "2,500",
    시간제보험: "1,000",
    보험료소급: "0",
    프로모션: "20,000",
    소득세: "16,500",
    실지급액: "450,000",
    "1차지급액": "250,000",
    "2차지급액": "200,000",
    정산문의: "010-9785-1293",
    입금날짜: "250308"
  }
];

$(document).ready(function(){
    $('#searchForm').submit(function(event){
        event.preventDefault();

        var searchDate = $('#searchDate').val().trim();
        var searchCode = $('#searchCode').val().trim().toUpperCase();

        if (!/^\d{6}$/.test(searchDate)) { 
            alert("입금 날짜는 6자리 숫자로 입력하세요."); 
            return; 
        }
        if (!/^C\d{9}$/.test(searchCode)) { 
            alert("검색 코드는 'C'로 시작하는 10자리 형식이어야 합니다."); 
            return; 
        }

        // 샘플 데이터에서 검색
        const result = sampleData.find(d => d.코드 === searchCode && d.입금날짜 === searchDate);

        if(!result){
            $('#result').html("<p style='color:red'>해당 데이터가 없습니다. 입력값을 다시 확인해주세요.</p>");
            return;
        }

        const period = calculatePeriod(searchDate);

        const tableHtml = `<table>
<tr><th colspan="2">개인별 정산서</th></tr>
<tr><td>기간</td><td>${period}</td></tr>
<tr><td>코드</td><td>${result.코드}</td></tr>
<tr><td>총 오더 수</td><td>${result.총오더수}</td></tr>
<tr><td>수령금액</td><td>${result.수령금액}</td></tr>
<tr><td>과세 전 금액</td><td>${result.과세전금액}</td></tr>
<tr><td>고용보험</td><td>${result.고용보험}</td></tr>
<tr><td>산재보험</td><td>${result.산재보험}</td></tr>
<tr><td>시간제보험</td><td>${result.시간제보험}</td></tr>
<tr><td>보험료소급</td><td>${result.보험료소급}</td></tr>
<tr><td>프로모션</td><td>${result.프로모션}</td></tr>
<tr><td>소득세 (3.3%)</td><td>${result.소득세}</td></tr>
<tr class="footer"><td>실지급액</td><td>${result.실지급액}</td></tr>
<tr><td>1차 지급액 (화요일)</td><td>${result["1차지급액"]}</td></tr>
<tr><td>2차 지급액 (금요일)</td><td>${result["2차지급액"]}</td></tr>
<tr><td colspan="2">정산문의: ${result.정산문의}</td></tr>
</table>`;

        $('#result').html(tableHtml);
    });
});
</script>
</body>
</html>
